/* =========================================================
   CrownTALK — Chat-style URL Input Panel
   - Works with your existing HTML structure
   - Theme-aware via global tokens
   - Mobile-friendly, crisp focus states
========================================================= */

/* ---------- Theme hooks & fallbacks ---------- */
:root {
  --ib-bg:          var(--card-bg, rgba(255,255,255,0.04));
  --ib-border:      var(--card-border, rgba(255,255,255,0.12));
  --ib-text:        var(--text, #e7e7ea);
  --ib-subtle:      var(--text-muted, #9aa0a6);
  --ib-placeholder: var(--placeholder, #9aa0a6);

  /* Accent uses the same glow tuple your button uses if available */
  --ib-accent-rgb:  var(--btn-glow, 129,140,248);   /* r,g,b */
  --ib-accent:      var(--btn-base, #6d28d9);       /* hex */
  --ib-key-bg:      rgba(255,255,255,.06);
}

/* ---------- Layout shell ---------- */
.ai-chat-input {
  margin-top: 10px;
}

.ai-chat-input .chat-container {
  position: relative;
  background: var(--ib-bg);
  border: 1px solid var(--ib-border);
  border-radius: 16px;
  padding: 14px;
  box-shadow:
    0 1px 0 rgba(255,255,255,0.06) inset,
    0 10px 30px rgba(0,0,0,0.25);
  overflow: hidden;
}

/* ---------- Header (title + badges) ---------- */
.ai-chat-input .chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 10px;
}

.ai-chat-input .status-section {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: var(--ib-text);
  font-weight: 600;
}

.ai-chat-input .status-indicator {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: rgb(var(--ib-accent-rgb));
  box-shadow: 0 0 0 0 rgba(var(--ib-accent-rgb), 0.6);
  animation: ib-ping 1.8s ease-out infinite;
}

.ai-chat-input .status-text {
  letter-spacing: .2px;
}

.ai-chat-input .badges {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.ai-chat-input .badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 2px 8px;
  border-radius: 9999px;
  border: 1px solid var(--ib-border);
  color: var(--ib-text);
  font-weight: 600;
  font-size: 0.72rem;
  letter-spacing: .2px;
  background: linear-gradient(
    to bottom,
    rgba(255,255,255,.06),
    rgba(0,0,0,.12)
  );
  box-shadow: 0 1px 0 rgba(255,255,255,.06) inset;
}

.ai-chat-input .badge-gpt {
  border-color: rgba(var(--ib-accent-rgb), .45);
  color: #fff;
  background:
    linear-gradient(
      180deg,
      color-mix(in srgb, var(--ib-accent) 100%, #ffffff 0%) 0%,
      color-mix(in srgb, var(--ib-accent) 80%, #000000 20%) 100%
    );
}

.ai-chat-input .badge-pro {
  border-color: rgba(234,179,8,.48); /* amber-500 */
  background:
    linear-gradient(180deg, rgba(234,179,8,.25), rgba(180,120,0,.15));
  color: #fde68a;
}

/* ---------- Input section ---------- */
.ai-chat-input .input-section {
  position: relative;
}

.ai-chat-input .main-input {
  width: 100%;
  min-height: 140px;
  max-height: 40vh;
  padding: 14px 14px 44px 14px; /* bottom space for gradient hint */
  background: transparent;
  color: var(--ib-text);
  border: 1px solid var(--ib-border);
  border-radius: 12px;
  outline: none;
  resize: vertical;
  line-height: 1.5;
  font: 500 0.95rem/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter,
        "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
  box-shadow:
    0 1px 0 rgba(255,255,255,.04) inset,
    0 6px 18px rgba(0,0,0,.18);
}

.ai-chat-input .main-input::placeholder {
  color: var(--ib-placeholder);
  opacity: .92;
}

/* focus ring – matches premium theme glow */
.ai-chat-input .main-input:focus {
  border-color: rgba(var(--ib-accent-rgb), .95);
  box-shadow:
    0 0 0 1px rgba(var(--ib-accent-rgb), .85),
    0 0 0 3px rgba(var(--ib-accent-rgb), .38),
    0 18px 42px rgba(0,0,0,.9);
}

/* fade hint at the bottom of the textarea (non-interactive) */
.ai-chat-input .gradient-overlay {
  position: absolute;
  left: 12px;
  right: 12px;
  bottom: 12px;
  height: 36px;
  pointer-events: none;
  background: linear-gradient(to bottom, transparent, var(--ib-bg));
  border-bottom-left-radius: 10px;
  border-bottom-right-radius: 10px;
}

/* ---------- Footer info row ---------- */
.ai-chat-input .footer-info {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin-top: 10px;
  color: var(--ib-subtle);
  font-size: .85rem;
}

.ai-chat-input .shortcut-info,
.ai-chat-input .system-status {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.ai-chat-input .info-icon {
  width: 16px;
  height: 16px;
  opacity: .75;
}

.ai-chat-input .shortcut-key {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 20px;
  min-width: 22px;
  padding: 0 6px;
  border-radius: 6px;
  border: 1px solid var(--ib-border);
  border-bottom-width: 2px;
  box-shadow:
    0 1px 0 rgba(255,255,255,.06) inset,
    0 1.5px 0 rgba(0,0,0,.4);
  background: var(--ib-key-bg);
  color: var(--ib-text);
  font: 600 0.72rem/1 ui-monospace, SFMono-Regular, Menlo, Consolas,
        "Liberation Mono", monospace;
}

.ai-chat-input .system-indicator {
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: #34d399; /* green */
  box-shadow: 0 0 0 0 rgba(52,211,153,.6);
  animation: ib-pulse 2s ease-out infinite;
}

/* ---------- Decorative floating overlay ---------- */
.ai-chat-input .floating-overlay {
  position: absolute;
  inset: -1px;
  border-radius: 16px;
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: .25;
  background:
    radial-gradient(120% 80% at 0% 0%, rgba(var(--ib-accent-rgb), .18), transparent 60%),
    radial-gradient(120% 80% at 100% 0%, rgba(255,255,255,.06), transparent 60%);
}

/* ---------- Animations ---------- */
@keyframes ib-ping {
  0%   { box-shadow: 0 0 0 0 rgba(var(--ib-accent-rgb), 0.6); }
  80%  { box-shadow: 0 0 0 10px rgba(var(--ib-accent-rgb), 0); }
  100% { box-shadow: 0 0 0 0 rgba(var(--ib-accent-rgb), 0); }
}

@keyframes ib-pulse {
  0%   { transform: scale(1);    box-shadow: 0 0 0 0 rgba(52,211,153,.4); }
  50%  { transform: scale(1.12); box-shadow: 0 0 0 6px rgba(52,211,153,0); }
  100% { transform: scale(1);    box-shadow: 0 0 0 0 rgba(52,211,153,0); }
}

/* ---------- Mobile tweaks ---------- */
@media (max-width: 640px) {
  .ai-chat-input .chat-container {
    padding: 12px;
    border-radius: 14px;
  }

  .ai-chat-input .badge {
    font-size: .7rem;
    padding: 2px 7px;
  }

  .ai-chat-input .main-input {
    min-height: 120px;
    max-height: 50vh;
    font-size: 0.9rem;
    padding: 12px 12px 40px 12px;
  }

  .ai-chat-input .footer-info {
    flex-direction: column;
    align-items: flex-start;
    gap: 6px;
    font-size: .78rem;
  }
}

/* ---------- Premium textarea scrollbar (desktop) ---------- */
@media (pointer: fine){
  .ai-chat-input .main-input{
    scrollbar-width: thin;
    scrollbar-color: rgba(var(--ib-accent-rgb), .75) rgba(15,23,42,.96);
  }

  .ai-chat-input .main-input::-webkit-scrollbar{
    width: 7px;
  }

  .ai-chat-input .main-input::-webkit-scrollbar-track{
    background: radial-gradient(
      circle at 0% 0%,
      rgba(255,255,255,.06),
      rgba(15,23,42,.98)
    );
    border-radius: 999px;
  }

  .ai-chat-input .main-input::-webkit-scrollbar-thumb{
    border-radius: 999px;
    background: linear-gradient(
      180deg,
      rgba(var(--ib-accent-rgb), .95),
      rgba(var(--ib-accent-rgb), .65)
    );
    box-shadow: 0 0 12px rgba(var(--ib-accent-rgb), .75);
  }
}

/* ---------- Respect reduced motion ---------- */
@media (prefers-reduced-motion: reduce){
  .ai-chat-input .status-indicator,
  .ai-chat-input .system-indicator{
    animation: none !important;
    box-shadow: none;
  }
}
